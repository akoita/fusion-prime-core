# Base Foundry configuration for Fusion Prime
# Used across all profiles via inheritance (Foundry v1.4.0+ feature)

[profile.default]
src = "escrow/src"
test = "test"
script = "script"
libs = ["lib"]
out = "out"
cache_path = "cache"

# Remappings for modular structure
# Cross-chain and escrow modules use src/ subdirs, so remap for script imports
remappings = [
    "forge-std/=lib/forge-std/src/",
    "@openzeppelin/=lib/openzeppelin-contracts-upgradeable/",
    "escrow/=escrow/src/",
    "cross-chain/=cross-chain/src/",
    "bridge/=bridge/src/",
    "shared/=shared/src/"
]

# Compiler settings
solc_version = "0.8.30"
evm_version = "cancun"
optimizer = true
optimizer_runs = 200
via_ir = true

# Build configuration
auto_detect_solc = false
offline = false
force = false

# File permissions for scripts
# Allow scripts to write deployment artifacts and read project files
fs_permissions = [
    { access = "read-write", path = "./deployments" },
    { access = "read", path = "./" }
]

# Testing
fuzz = { runs = 256, max_test_rejects = 65536 }
invariant = { runs = 256, depth = 15, fail_on_revert = false }
verbosity = 2

# Documentation
extra_output = ["storageLayout", "devdoc", "userdoc", "metadata"]
extra_output_files = ["metadata"]

# Gas reporting
gas_reports = ["*"]
