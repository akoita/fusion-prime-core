[tool:pytest]
# Pytest configuration for Fusion Prime
minversion = 6.0
asyncio_mode = auto
addopts =
    --strict-markers
    --strict-config
    --verbose
    --tb=short
    --maxfail=5
    --junitxml=test-reports/pytest-results.xml
    --html=test-reports/pytest-report.html
    --self-contained-html
    --cov=services
    --cov=integrations
    --cov-report=html:test-reports/coverage-html
    --cov-report=xml:test-reports/coverage.xml
    --cov-report=term-missing
    --cov-fail-under=80
    --disable-warnings
testpaths =
    services
    integrations
    tests
markers =
    unit: Unit tests
    integration: Integration tests
    e2e: End-to-end tests
    slow: Slow running tests
    serial: Tests that must run sequentially (cannot run in parallel)
    contract: Smart contract tests
    relayer: Event relayer tests
    pubsub: Pub/Sub tests
    database: Database tests
    settlement: Settlement service tests
    health: Health check tests
    remote_testnet: Remote testnet tests
    remote_production: Remote production tests
    remote_integration: Remote integration tests
    real_deployment: Real deployed service tests
    scenario_based: Scenario-based workflow tests
    event_workflow: Event-driven workflow tests
filterwarnings =
    # Ignore websockets.legacy deprecation warning from uvicorn (third-party issue)
    # uvicorn 0.38.0 still uses websockets.legacy and hasn't migrated to new API yet
    # See: https://github.com/encode/uvicorn/issues/2476
    ignore::DeprecationWarning:websockets.legacy
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::UserWarning
